<!DOCTYPE html>
<html lang="en" data-root="https://fsprojects.github.io/ExcelFinancialFunctions/">
<head>
    <meta charset="UTF-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Luca Bolognese" name="author">
    <!-- Opengraph properties (https://ogp.me/) -->
    <meta property="og:site_name" content="ExcelFinancialFunctions">
    <meta property="og:title" content="Compatibility
" />
    <meta property="og:url" content="https://fsprojects.github.io/ExcelFinancialFunctions/compatibility.html">
    <meta property="og:type" content="website" />
    <!-- Twitter cards (https://developer.twitter.com/en/docs/twitter-for-websites/cards/overview/summary-card-with-large-image) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="https://fsprojects.github.io/ExcelFinancialFunctions/">
    <meta name="twitter:title" content="Compatibility
">
    
    <title>Compatibility
 | ExcelFinancialFunctions</title>
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"></script>
    <link href="https://fsprojects.github.io/ExcelFinancialFunctions/img/favicon.ico" rel="icon" sizes="32x32" type="image/png"/>
    <script type="application/javascript" src="https://fsprojects.github.io/ExcelFinancialFunctions/content/fsdocs-theme-set-dark.js"></script>
    <link href="https://fsprojects.github.io/ExcelFinancialFunctions/content/fsdocs-default.css" rel="stylesheet" type="text/css"/>
    <link href="https://fsprojects.github.io/ExcelFinancialFunctions/content/fsdocs-theme.css" rel="stylesheet" type="text/css"/>
    
    
</head>
<body class="content">
<header>
    <div class="start">
        <div id="menu-toggle">
            <iconify-icon class="icon closed" height="22" icon="eva:menu-fill" width="22"></iconify-icon>
            <iconify-icon class="icon open" height="22" icon="mi:close" width="22"></iconify-icon>
            <input type="checkbox" name="mobile-menu" />
            <ul class="menu">
                <li class="nav-header">Links</li>
                <li class="nav-item"><a class="nav-link" href="https://github.com/fsprojects/ExcelFinancialFunctions/blob/master/LICENSE.txt">License</a>
                </li>
                <li class="nav-item"><a class="nav-link"
                                        href="https://github.com/fsprojects/ExcelFinancialFunctions/blob/master/RELEASE_NOTES.md">Release
                    Notes</a></li>
                <li class="nav-item"><a class="nav-link" href="https://github.com/fsprojects/ExcelFinancialFunctions/">Source
                    Repository</a></li>
                <li class="nav-header">
  Documentation
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/ExcelFinancialFunctions/openofficediff.html">
    Difference between OpenOffice and the library

  </a>
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://fsprojects.github.io/ExcelFinancialFunctions/compatibility.html">
    Compatibility

  </a>
</li>
                <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fsprojects.github.io/ExcelFinancialFunctions/reference/index.html">
    All Namespaces
  </a>
</li>
            </ul>
        </div>
        <a href="https://fsprojects.github.io/ExcelFinancialFunctions/">
            <img alt="Header menu logo" src="https://fsprojects.github.io/ExcelFinancialFunctions/img/logo.png">
            <strong>ExcelFinancialFunctions</strong>
        </a>
    </div>
    <div class="end">
        <a href="https://github.com/fsprojects/ExcelFinancialFunctions/" target="_blank">
            <iconify-icon icon="uil:github" width="26" height="26"></iconify-icon>
        </a>
        <iconify-icon id="search-btn" icon="carbon:search" class="search" width="24" height="24"></iconify-icon>
        <fsdocs-theme-toggle></fsdocs-theme-toggle>
    </div>
</header>
<aside id="fsdocs-main-menu">
    <ul class="menu">
        <li class="nav-header">Links</li>
        <li class="nav-item"><a class="nav-link" href="https://github.com/fsprojects/ExcelFinancialFunctions/blob/master/LICENSE.txt">License</a>
        </li>
        <li class="nav-item"><a class="nav-link"
                                href="https://github.com/fsprojects/ExcelFinancialFunctions/blob/master/RELEASE_NOTES.md">Release
            Notes</a></li>
        <li class="nav-item"><a class="nav-link" href="https://github.com/fsprojects/ExcelFinancialFunctions/">Source
            Repository</a></li>
        <li class="nav-header">
  Documentation
</li>             
<li class="nav-item ">
  <a class="nav-link" href="https://fsprojects.github.io/ExcelFinancialFunctions/openofficediff.html">
    Difference between OpenOffice and the library

  </a>
</li>             
<li class="nav-item active">
  <a class="nav-link" href="https://fsprojects.github.io/ExcelFinancialFunctions/compatibility.html">
    Compatibility

  </a>
</li>
        <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fsprojects.github.io/ExcelFinancialFunctions/reference/index.html">
    All Namespaces
  </a>
</li>
    </ul>
</aside>
<main>
    <div id="content">
        <h1><a name="Compatibility" class="anchor" href="#Compatibility">Compatibility</a></h1>
<p>This library replicates Excel behavior. There're 199,252 tests verifying the results against Excel 2010 and their number can be raised significantly by adding new test values. Several tests check the function properties, e.g. that bond duration can't be greater than maturity.<br />
The current version matches Excel 2010, which is slightly different from 2003, see <a href="http://blogs.office.com/b/microsoft-excel/archive/2009/09/10/function-improvements-in-excel-2010.aspx">Function Improvements in Excel 2010</a>.
Note, that console tests require Excel, whereas the unit tests can be run even on mono - their parameters and expected results are stored in files.</p>
<p>However, there're still some differences comparing to Excel.
<em>Read more about OpenOffice vs Excel <a href="openofficediff.html">here</a>.</em></p>
<h2><a name="COUPDAYS" class="anchor" href="#COUPDAYS">COUPDAYS</a></h2>
<p>The Excel algorithm doesn't respect equality <code>coupDays = coupDaysBS + coupDaysNC</code>. The library result differs from Excel by +/- one or two days when the date spans a leap year. (<a href="http://office.microsoft.com/en-us/excel/HP052090311033.aspx">office docs</a>)</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="id">settlement</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="fn">DateTime</span><span class="pn">(</span><span class="n">2012</span><span class="pn">,</span> <span class="n">1</span><span class="pn">,</span> <span class="n">1</span><span class="pn">)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="id">maturity</span>   <span class="o">=</span> <span onmouseout="hideTip(event, 'fs5', 7)" onmouseover="showTip(event, 'fs5', 7)" class="fn">DateTime</span><span class="pn">(</span><span class="n">2016</span><span class="pn">,</span> <span class="n">2</span><span class="pn">,</span> <span class="n">29</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs7', 8)" onmouseover="showTip(event, 'fs7', 8)" class="id">param</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs4', 9)" onmouseover="showTip(event, 'fs4', 9)" class="id">settlement</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs6', 10)" onmouseover="showTip(event, 'fs6', 10)" class="id">maturity</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="en">Frequency</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="id">SemiAnnual</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs10', 13)" onmouseover="showTip(event, 'fs10', 13)" class="en">DayCountBasis</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs11', 14)" onmouseover="showTip(event, 'fs11', 14)" class="id">ActualActual</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs12', 15)" onmouseover="showTip(event, 'fs12', 15)" class="id">days</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 16)" onmouseover="showTip(event, 'fs13', 16)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs14', 17)" onmouseover="showTip(event, 'fs14', 17)" class="id">CoupDays</span> <span onmouseout="hideTip(event, 'fs7', 18)" onmouseover="showTip(event, 'fs7', 18)" class="id">param</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 19)" onmouseover="showTip(event, 'fs15', 19)" class="id">bs</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 20)" onmouseover="showTip(event, 'fs13', 20)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="id">CoupDaysBS</span> <span onmouseout="hideTip(event, 'fs7', 22)" onmouseover="showTip(event, 'fs7', 22)" class="id">param</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 23)" onmouseover="showTip(event, 'fs17', 23)" class="id">nc</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs18', 25)" onmouseover="showTip(event, 'fs18', 25)" class="id">CoupDaysNC</span> <span onmouseout="hideTip(event, 'fs7', 26)" onmouseover="showTip(event, 'fs7', 26)" class="id">param</span>
<span class="c">// Excel: 2</span>
<span onmouseout="hideTip(event, 'fs12', 27)" onmouseover="showTip(event, 'fs12', 27)" class="id">days</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs15', 28)" onmouseover="showTip(event, 'fs15', 28)" class="id">bs</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="id">nc</span>
<span class="fsi">val days : float = 182.0</span>
<span class="fsi">val bs : float = 123.0</span>
<span class="fsi">val nc : float = 59.0</span>
<span class="fsi">val it : float = 0.0</span>
</code></pre>
<h2><a name="VDB" class="anchor" href="#VDB">VDB</a></h2>
<p>In the Excel version of this algorithm the depreciation in the period (0,1) is not the same as the sum of the depreciations in periods (0,0.5) (0.5,1)<br />
Notice that in Excel by using '1' (no_switch) instead of '0' as the last parameter everything works as expected.<br />
In truth, the last parameter should have no influence in the calculation given that in the first period there is no switch to sln depreciation.<br />
Overall, the algorithm is correct, even if it disagrees with Excel when startperiod is fractional. (<a href="http://office.microsoft.com/en-us/excel/HP052093341033.aspx">office docs</a>)</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 30)" onmouseover="showTip(event, 'fs19', 30)" class="fn">vdb</span> <span onmouseout="hideTip(event, 'fs20', 31)" onmouseover="showTip(event, 'fs20', 31)" class="fn">sp</span> <span onmouseout="hideTip(event, 'fs21', 32)" onmouseover="showTip(event, 'fs21', 32)" class="fn">ep</span> <span onmouseout="hideTip(event, 'fs22', 33)" onmouseover="showTip(event, 'fs22', 33)" class="fn">switch</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs13', 34)" onmouseover="showTip(event, 'fs13', 34)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs23', 35)" onmouseover="showTip(event, 'fs23', 35)" class="id">Vdb</span><span class="pn">(</span><span class="n">100.0</span><span class="pn">,</span> <span class="n">10.0</span><span class="pn">,</span> <span class="n">13.0</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs20', 36)" onmouseover="showTip(event, 'fs20', 36)" class="fn">sp</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs21', 37)" onmouseover="showTip(event, 'fs21', 37)" class="fn">ep</span><span class="pn">,</span> <span class="n">1.0</span><span class="pn">,</span> 
        <span class="k">if</span> <span onmouseout="hideTip(event, 'fs22', 38)" onmouseover="showTip(event, 'fs22', 38)" class="fn">switch</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs24', 39)" onmouseover="showTip(event, 'fs24', 39)" class="en">VdbSwitch</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs25', 40)" onmouseover="showTip(event, 'fs25', 40)" class="id">SwitchToStraightLine</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs24', 41)" onmouseover="showTip(event, 'fs24', 41)" class="en">VdbSwitch</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs26', 42)" onmouseover="showTip(event, 'fs26', 42)" class="id">DontSwitchToStraightLine</span><span class="pn">)</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs27', 43)" onmouseover="showTip(event, 'fs27', 43)" class="id">p1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 44)" onmouseover="showTip(event, 'fs19', 44)" class="fn">vdb</span> <span class="n">0.0</span> <span class="n">0.5</span> <span class="k">false</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs28', 45)" onmouseover="showTip(event, 'fs28', 45)" class="id">p2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 46)" onmouseover="showTip(event, 'fs19', 46)" class="fn">vdb</span> <span class="n">0.5</span> <span class="n">1.0</span> <span class="k">false</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs29', 47)" onmouseover="showTip(event, 'fs29', 47)" class="id">total</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 48)" onmouseover="showTip(event, 'fs19', 48)" class="fn">vdb</span> <span class="n">0.0</span> <span class="n">1.0</span> <span class="k">false</span>
<span class="c">// Excel: 0.1479</span>
<span onmouseout="hideTip(event, 'fs29', 49)" onmouseover="showTip(event, 'fs29', 49)" class="id">total</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs27', 50)" onmouseover="showTip(event, 'fs27', 50)" class="id">p1</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs28', 51)" onmouseover="showTip(event, 'fs28', 51)" class="id">p2</span> 
<span class="fsi">val p1 : float = 3.846153846</span>
<span class="fsi">val p2 : float = 3.846153846</span>
<span class="fsi">val total : float = 7.692307692</span>
<span class="fsi">val it : float = 0.0</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs30', 52)" onmouseover="showTip(event, 'fs30', 52)" class="id">p1sw</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 53)" onmouseover="showTip(event, 'fs19', 53)" class="fn">vdb</span> <span class="n">0.0</span> <span class="n">0.5</span> <span class="k">true</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs31', 54)" onmouseover="showTip(event, 'fs31', 54)" class="id">p2sw</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 55)" onmouseover="showTip(event, 'fs19', 55)" class="fn">vdb</span> <span class="n">0.5</span> <span class="n">1.0</span> <span class="k">true</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs32', 56)" onmouseover="showTip(event, 'fs32', 56)" class="id">totalsw</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs19', 57)" onmouseover="showTip(event, 'fs19', 57)" class="fn">vdb</span> <span class="n">0.0</span> <span class="n">1.0</span> <span class="k">true</span>
<span class="c">// Excel: 0.0000</span>
<span onmouseout="hideTip(event, 'fs32', 58)" onmouseover="showTip(event, 'fs32', 58)" class="id">totalsw</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs30', 59)" onmouseover="showTip(event, 'fs30', 59)" class="id">p1sw</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs31', 60)" onmouseover="showTip(event, 'fs31', 60)" class="id">p2sw</span> 
<span class="fsi">val p1sw : float = 3.846153846</span>
<span class="fsi">val p2sw : float = 3.846153846</span>
<span class="fsi">val totalsw : float = 7.692307692</span>
<span class="fsi">val it : float = 0.0</span>
</code></pre>
<h2><a name="AMORDEGRC" class="anchor" href="#AMORDEGRC">AMORDEGRC</a></h2>
<p>ExcelCompliant is used because Excel stores 13 digits. AmorDegrc algorithm rounds numbers<br />
and returns different results unless the numbers get rounded to 13 digits before rounding them.<br />
I.E. 22.49999999999999 is considered 22.5 by Excel, but 22.4 by the .NET framework. (<a href="http://office.microsoft.com/en-us/excel/HP052089841033.aspx">office docs</a>)</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs33', 61)" onmouseover="showTip(event, 'fs33', 61)" class="fn">amorDegrc</span> <span onmouseout="hideTip(event, 'fs34', 62)" onmouseover="showTip(event, 'fs34', 62)" class="fn">excelCompliant</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs13', 63)" onmouseover="showTip(event, 'fs13', 63)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 64)" onmouseover="showTip(event, 'fs35', 64)" class="id">AmorDegrc</span><span class="pn">(</span><span class="n">100.0</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs5', 65)" onmouseover="showTip(event, 'fs5', 65)" class="fn">DateTime</span><span class="pn">(</span><span class="n">2014</span><span class="pn">,</span><span class="n">1</span><span class="pn">,</span><span class="n">1</span><span class="pn">)</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs5', 66)" onmouseover="showTip(event, 'fs5', 66)" class="fn">DateTime</span><span class="pn">(</span><span class="n">2016</span><span class="pn">,</span><span class="n">1</span><span class="pn">,</span><span class="n">1</span><span class="pn">)</span><span class="pn">,</span> 
        <span class="n">50.0</span><span class="pn">,</span> <span class="n">1.0</span><span class="pn">,</span> <span class="n">0.3</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs10', 67)" onmouseover="showTip(event, 'fs10', 67)" class="en">DayCountBasis</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs11', 68)" onmouseover="showTip(event, 'fs11', 68)" class="id">ActualActual</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs34', 69)" onmouseover="showTip(event, 'fs34', 69)" class="fn">excelCompliant</span><span class="pn">)</span>

<span onmouseout="hideTip(event, 'fs33', 70)" onmouseover="showTip(event, 'fs33', 70)" class="fn">amorDegrc</span> <span class="k">true</span>
<span class="fsi">val it : float = 23.0</span>
<span onmouseout="hideTip(event, 'fs33', 71)" onmouseover="showTip(event, 'fs33', 71)" class="fn">amorDegrc</span> <span class="k">false</span>
<span class="fsi">val it : float = 22.0</span>
</code></pre>
<h2><a name="DDB" class="anchor" href="#DDB">DDB</a></h2>
<p>Excel Ddb has two interesting characteristics:<br />
1. It special cases ddb for fractional periods between 0 and 1 by considering them to be 1<br />
2. It is inconsistent with VDB(..., True) for fractional periods, even if VDB(..., True) is defined to be the same as ddb. The algorithm for VDB is theoretically correct.<br />
This function makes the same 1. adjustment.(<a href="http://office.microsoft.com/en-us/excel/HP052090511033.aspx">office docs</a>)</p>
<h2><a name="RATE-and-ODDFYIELD" class="anchor" href="#RATE-and-ODDFYIELD">RATE and ODDFYIELD</a></h2>
<p>Excel uses a different root finding algo. Sometimes the library results are better, sometimes Excel's. (<a href="http://office.microsoft.com/en-us/excel/HP052092321033.aspx">office docs</a>)</p>
<h2><a name="XIRR-and-XNPV" class="anchor" href="#XIRR-and-XNPV">XIRR and XNPV</a></h2>
<p>XIRR and XNPV functions are related: the net present value, given the internal rate of return, should be zero.
However, XNPV works only for positive rates even though the XIRR results might be negative.
The results can also be different because of the root finding functions. (<a href="http://office.microsoft.com/en-us/excel/HP052093411033.aspx">office docs</a>)</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs36', 72)" onmouseover="showTip(event, 'fs36', 72)" class="id">dates</span> <span class="o">=</span> <span class="pn">[|</span><span onmouseout="hideTip(event, 'fs5', 73)" onmouseover="showTip(event, 'fs5', 73)" class="fn">DateTime</span><span class="pn">(</span><span class="n">2000</span><span class="pn">,</span> <span class="n">2</span><span class="pn">,</span> <span class="n">29</span><span class="pn">)</span><span class="pn">;</span> <span onmouseout="hideTip(event, 'fs5', 74)" onmouseover="showTip(event, 'fs5', 74)" class="fn">DateTime</span><span class="pn">(</span><span class="n">2000</span><span class="pn">,</span> <span class="n">3</span><span class="pn">,</span> <span class="n">31</span><span class="pn">)</span><span class="pn">|]</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs37', 75)" onmouseover="showTip(event, 'fs37', 75)" class="id">values</span> <span class="o">=</span> <span class="pn">[|</span><span class="n">206101714.849377</span><span class="pn">;</span> <span class="o">-</span><span class="n">156650972.54265</span><span class="pn">|]</span>
<span class="c">// Excel: -0.960452189</span>
<span onmouseout="hideTip(event, 'fs13', 76)" onmouseover="showTip(event, 'fs13', 76)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 77)" onmouseover="showTip(event, 'fs38', 77)" class="id">XIrr</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs37', 78)" onmouseover="showTip(event, 'fs37', 78)" class="id">values</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 79)" onmouseover="showTip(event, 'fs36', 79)" class="id">dates</span><span class="pn">,</span> <span class="o">-</span><span class="n">0.1</span><span class="pn">)</span>
<span class="fsi">val it : float = -0.960452195</span>
<span class="c">// Excel: #NUM!</span>
<span onmouseout="hideTip(event, 'fs13', 80)" onmouseover="showTip(event, 'fs13', 80)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 81)" onmouseover="showTip(event, 'fs39', 81)" class="id">XNpv</span><span class="pn">(</span><span class="o">-</span><span class="n">0.960452195</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs37', 82)" onmouseover="showTip(event, 'fs37', 82)" class="id">values</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 83)" onmouseover="showTip(event, 'fs36', 83)" class="id">dates</span><span class="pn">)</span>
<span class="fsi">val it : float = -0.008917063475</span>
<span class="c">// Excel: #NUM!</span>
<span onmouseout="hideTip(event, 'fs13', 84)" onmouseover="showTip(event, 'fs13', 84)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 85)" onmouseover="showTip(event, 'fs39', 85)" class="id">XNpv</span><span class="pn">(</span><span class="o">-</span><span class="n">0.960452189</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs37', 86)" onmouseover="showTip(event, 'fs37', 86)" class="id">values</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 87)" onmouseover="showTip(event, 'fs36', 87)" class="id">dates</span><span class="pn">)</span>
<span class="fsi">val it : float = 2.646784514</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs40', 88)" onmouseover="showTip(event, 'fs40', 88)" class="id">values2</span> <span class="o">=</span> <span class="pn">[|</span><span class="n">15108163.3840923</span><span class="pn">;</span> <span class="o">-</span><span class="n">75382259.6628424</span><span class="pn">|]</span>
<span class="c">// Excel: #NUM!</span>
<span onmouseout="hideTip(event, 'fs13', 89)" onmouseover="showTip(event, 'fs13', 89)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 90)" onmouseover="showTip(event, 'fs38', 90)" class="id">XIrr</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs40', 91)" onmouseover="showTip(event, 'fs40', 91)" class="id">values2</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 92)" onmouseover="showTip(event, 'fs36', 92)" class="id">dates</span><span class="pn">,</span> <span class="o">-</span><span class="n">0.1</span><span class="pn">)</span>
<span class="fsi">val it : float = 165601346.1</span>
<span class="c">// Excel: 165601345.6</span>
<span onmouseout="hideTip(event, 'fs13', 93)" onmouseover="showTip(event, 'fs13', 93)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs38', 94)" onmouseover="showTip(event, 'fs38', 94)" class="id">XIrr</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs40', 95)" onmouseover="showTip(event, 'fs40', 95)" class="id">values2</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 96)" onmouseover="showTip(event, 'fs36', 96)" class="id">dates</span><span class="pn">,</span> <span class="n">0.1</span><span class="pn">)</span>
<span class="fsi">val it : float = 165601346.1</span>
<span onmouseout="hideTip(event, 'fs13', 97)" onmouseover="showTip(event, 'fs13', 97)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 98)" onmouseover="showTip(event, 'fs39', 98)" class="id">XNpv</span><span class="pn">(</span><span class="n">165601346.1</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs40', 99)" onmouseover="showTip(event, 'fs40', 99)" class="id">values2</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 100)" onmouseover="showTip(event, 'fs36', 100)" class="id">dates</span><span class="pn">)</span>
<span class="fsi">val it : float = -0.000269997865</span>
<span onmouseout="hideTip(event, 'fs13', 101)" onmouseover="showTip(event, 'fs13', 101)" class="rt">Financial</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs39', 102)" onmouseover="showTip(event, 'fs39', 102)" class="id">XNpv</span><span class="pn">(</span><span class="n">165601345.6</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs40', 103)" onmouseover="showTip(event, 'fs40', 103)" class="id">values2</span><span class="pn">,</span> <span onmouseout="hideTip(event, 'fs36', 104)" onmouseover="showTip(event, 'fs36', 104)" class="id">dates</span><span class="pn">)</span>
<span class="fsi">val it : float = -0.004144238308</span>
</code></pre>

        <div class="fsdocs-tip" id="fs1">namespace System</div>
<div class="fsdocs-tip" id="fs2">namespace Excel</div>
<div class="fsdocs-tip" id="fs3">namespace Excel.FinancialFunctions</div>
<div class="fsdocs-tip" id="fs4">val settlement: DateTime</div>
<div class="fsdocs-tip" id="fs5">Multiple items<br />[&lt;Struct&gt;]
type DateTime =
  new: year: int * month: int * day: int -&gt; unit + 10 overloads
  member Add: value: TimeSpan -&gt; DateTime
  member AddDays: value: float -&gt; DateTime
  member AddHours: value: float -&gt; DateTime
  member AddMilliseconds: value: float -&gt; DateTime
  member AddMinutes: value: float -&gt; DateTime
  member AddMonths: months: int -&gt; DateTime
  member AddSeconds: value: float -&gt; DateTime
  member AddTicks: value: int64 -&gt; DateTime
  member AddYears: value: int -&gt; DateTime
  ...<br /><em>&lt;summary&gt;Represents an instant in time, typically expressed as a date and time of day.&lt;/summary&gt;</em><br /><br />--------------------<br />DateTime ()<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(ticks: int64, kind: DateTimeKind) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, calendar: Globalization.Calendar) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, kind: DateTimeKind) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, calendar: Globalization.Calendar) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em><br />DateTime(year: int, month: int, day: int, hour: int, minute: int, second: int, millisecond: int, kind: DateTimeKind) : DateTime<br />&#160;&#160;&#160;<em>(+0 other overloads)</em></div>
<div class="fsdocs-tip" id="fs6">val maturity: DateTime</div>
<div class="fsdocs-tip" id="fs7">val param: DateTime * DateTime * Frequency * DayCountBasis</div>
<div class="fsdocs-tip" id="fs8">[&lt;Struct&gt;]
type Frequency =
  | Annual = 1
  | SemiAnnual = 2
  | Quarterly = 4<br /><em>&lt;summary&gt;
 The number of coupon payments per year
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs9">Frequency.SemiAnnual: Frequency = 2</div>
<div class="fsdocs-tip" id="fs10">[&lt;Struct&gt;]
type DayCountBasis =
  | UsPsa30_360 = 0
  | ActualActual = 1
  | Actual360 = 2
  | Actual365 = 3
  | Europ30_360 = 4<br /><em>&lt;summary&gt;
 The type of Day Count Basis
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs11">DayCountBasis.ActualActual: DayCountBasis = 1<br /><em>&lt;summary&gt;
 Actual/Actual
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs12">val days: float</div>
<div class="fsdocs-tip" id="fs13">type Financial =
  static member AccrInt: issue: DateTime * firstInterest: DateTime * settlement: DateTime * rate: float * par: float * frequency: Frequency * basis: DayCountBasis * calcMethod: AccrIntCalcMethod -&gt; float + 1 overload
  static member AccrIntM: issue: DateTime * settlement: DateTime * rate: float * par: float * basis: DayCountBasis -&gt; float
  static member AmorDegrc: cost: float * datePurchased: DateTime * firstPeriod: DateTime * salvage: float * period: float * rate: float * basis: DayCountBasis * excelCompliant: bool -&gt; float
  static member AmorLinc: cost: float * datePurchased: DateTime * firstPeriod: DateTime * salvage: float * period: float * rate: float * basis: DayCountBasis -&gt; float
  static member CoupDays: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; float
  static member CoupDaysBS: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; float
  static member CoupDaysNC: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; float
  static member CoupNCD: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; DateTime
  static member CoupNum: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; float
  static member CoupPCD: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; DateTime
  ...<br /><em>&lt;summary&gt;
 A wrapper class to expose the Excel financial functions API to .NET clients
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs14">static member Financial.CoupDays: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; float</div>
<div class="fsdocs-tip" id="fs15">val bs: float</div>
<div class="fsdocs-tip" id="fs16">static member Financial.CoupDaysBS: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; float</div>
<div class="fsdocs-tip" id="fs17">val nc: float</div>
<div class="fsdocs-tip" id="fs18">static member Financial.CoupDaysNC: settlement: DateTime * maturity: DateTime * frequency: Frequency * basis: DayCountBasis -&gt; float</div>
<div class="fsdocs-tip" id="fs19">val vdb: sp: float -&gt; ep: float -&gt; switch: bool -&gt; float</div>
<div class="fsdocs-tip" id="fs20">val sp: float</div>
<div class="fsdocs-tip" id="fs21">val ep: float</div>
<div class="fsdocs-tip" id="fs22">val switch: bool</div>
<div class="fsdocs-tip" id="fs23">static member Financial.Vdb: cost: float * salvage: float * life: float * startPeriod: float * endPeriod: float -&gt; float<br />static member Financial.Vdb: cost: float * salvage: float * life: float * startPeriod: float * endPeriod: float * factor: float -&gt; float<br />static member Financial.Vdb: cost: float * salvage: float * life: float * startPeriod: float * endPeriod: float * factor: float * noSwitch: VdbSwitch -&gt; float</div>
<div class="fsdocs-tip" id="fs24">[&lt;Struct&gt;]
type VdbSwitch =
  | DontSwitchToStraightLine = 1
  | SwitchToStraightLine = 0<br /><em>&lt;summary&gt;
 Specifies whether to switch to straight-line depreciation when depreciation is greater than the declining balance calculation
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs25">VdbSwitch.SwitchToStraightLine: VdbSwitch = 0</div>
<div class="fsdocs-tip" id="fs26">VdbSwitch.DontSwitchToStraightLine: VdbSwitch = 1</div>
<div class="fsdocs-tip" id="fs27">val p1: float</div>
<div class="fsdocs-tip" id="fs28">val p2: float</div>
<div class="fsdocs-tip" id="fs29">val total: float</div>
<div class="fsdocs-tip" id="fs30">val p1sw: float</div>
<div class="fsdocs-tip" id="fs31">val p2sw: float</div>
<div class="fsdocs-tip" id="fs32">val totalsw: float</div>
<div class="fsdocs-tip" id="fs33">val amorDegrc: excelCompliant: bool -&gt; float</div>
<div class="fsdocs-tip" id="fs34">val excelCompliant: bool</div>
<div class="fsdocs-tip" id="fs35">static member Financial.AmorDegrc: cost: float * datePurchased: DateTime * firstPeriod: DateTime * salvage: float * period: float * rate: float * basis: DayCountBasis * excelCompliant: bool -&gt; float</div>
<div class="fsdocs-tip" id="fs36">val dates: DateTime array</div>
<div class="fsdocs-tip" id="fs37">val values: float array</div>
<div class="fsdocs-tip" id="fs38">static member Financial.XIrr: values: float seq * dates: DateTime seq -&gt; float<br />static member Financial.XIrr: values: float seq * dates: DateTime seq * guess: float -&gt; float</div>
<div class="fsdocs-tip" id="fs39">static member Financial.XNpv: rate: float * values: float seq * dates: DateTime seq -&gt; float</div>
<div class="fsdocs-tip" id="fs40">val values2: float array</div>

    </div>
</main>
<aside id="fsdocs-page-menu">
    <p id="on-this-page">On this page</p>
    <ul>
  <li class="level-1">
    <a href="#Compatibility">
      Compatibility
    </a>
  </li>
  <li class="level-2">
    <a href="#COUPDAYS">
      COUPDAYS
    </a>
  </li>
  <li class="level-2">
    <a href="#VDB">
      VDB
    </a>
  </li>
  <li class="level-2">
    <a href="#AMORDEGRC">
      AMORDEGRC
    </a>
  </li>
  <li class="level-2">
    <a href="#DDB">
      DDB
    </a>
  </li>
  <li class="level-2">
    <a href="#RATE-and-ODDFYIELD">
      RATE and ODDFYIELD
    </a>
  </li>
  <li class="level-2">
    <a href="#XIRR-and-XNPV">
      XIRR and XNPV
    </a>
  </li>
</ul>
</aside>
<dialog>
    <input type="search" placeholder="Search docs" />
    <div class="results">
        <ul></ul>
        <p class="empty">Type something to start searching.</p>
    </div>
</dialog>
<script type="module" src="https://fsprojects.github.io/ExcelFinancialFunctions/content/fsdocs-tips.js"></script>
<script type="module" src="https://fsprojects.github.io/ExcelFinancialFunctions/content/fsdocs-theme-toggle.js"></script>
<script type="module" src="https://fsprojects.github.io/ExcelFinancialFunctions/content/fsdocs-theme.js"></script>
<script type="module" src="https://fsprojects.github.io/ExcelFinancialFunctions/content/fsdocs-search.js"></script>

</body>
</html>